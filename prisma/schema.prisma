generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["app", "auth", "public"]
}

model profiles {
  id                       String    @id @db.Uuid
  email                    String    @unique
  full_name                String?
  phone                    String?
  avatar_url               String?
  preferences              Json?     @default("{}")
  loyalty_points           Int?      @default(0)
  total_orders             Int?      @default(0)
  total_spent              Decimal?  @default(0.00) @db.Decimal(10, 2)
  notification_preferences Json?     @default("{\"sms\": false, \"push\": true, \"email\": true}")
  created_at               DateTime? @default(now()) @db.Timestamptz(6)
  updated_at               DateTime? @default(now()) @db.Timestamptz(6)
  last_sync_at             DateTime? @db.Timestamptz(6)
  users                    users     @relation(fields: [id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@schema("app")
}

model users {
  id                 String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email              String    @unique
  encrypted_password String
  created_at         DateTime? @default(now()) @db.Timestamptz(6)
  updated_at         DateTime? @default(now()) @db.Timestamptz(6)
  profiles           profiles?

  @@index([email], map: "idx_auth_users_email")
  @@schema("auth")
}
